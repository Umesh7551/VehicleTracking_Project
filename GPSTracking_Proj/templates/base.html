<!DOCTYPE html>
{% load static %}

<html lang="en"
      class="light-style customizer-hide"
      dir="ltr"
      data-theme="theme-default"
      data-assets-path="{% static 'assets/' %}"
      data-template="vertical-menu-template-free">
<head>
    <meta charset="UTF-8">
    <title>{% block title %} {% endblock title %}</title>
    <meta name="description"
          content="EminentGPSTracking.com is your authoritative and affordable source for GPS Trackers. We provide private industry, small businesses, and government agencies with Live GPS Tracking Systems which track vehicles and payloads in Real Time.">
    <meta name="keywords"
          content="GPSTracking, GPS Tracking, GPS Tracker, GPS Trackers, GPS, fleet tracking, vehicle tracking, vehicle gps, car tracking, gps system, car gps, fleet gps, gps tracking system, gps vehicle tracking, mobile location unit, gps tracking device, gps tracking equipment, gps vehicle tracking system, constant monitoring, automobile and theft recovery, location system, gps vehicle tracking system, fleet management, Teen Tracking, live tracking, realtime gps">
    <meta name="robots" content="index, follow"/>
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}"/>

    <!--    <link rel="icon" type="image/x-icon" href="../assets/img/favicon/favicon.ico" />-->

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
            href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
            rel="stylesheet"
    />

    <!-- Icons. Uncomment required icon fonts -->
    <link rel="stylesheet" href="{% static 'assets/vendor/fonts/boxicons.css' %}"/>

    <!-- Core CSS -->
    <link rel="stylesheet" href="{% static 'assets/vendor/css/core.css' %}" class="template-customizer-core-css"/>
    <link rel="stylesheet" href="{% static 'assets/vendor/css/theme-default.css' %}"
          class="template-customizer-theme-css"/>
    <!--    <link rel="stylesheet" href="{% static 'assets/css/demo.css' %}"/>-->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.2/dist/sweetalert2.min.css" rel="stylesheet">
    <!-- Vendors CSS -->
    <link rel="stylesheet" href="{% static 'assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css' %}"/>
    <link rel="stylesheet" href="{% static 'assets/vendor/css/pages/page-auth.css' %}"/>
    <!-- Bootstrap CSS CDN starts here -->
    <!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"-->
    <!--          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">-->
    <link href="{% static 'bootstrap5/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css">
    <!-- Bootstrap CSS CDN ends here -->

    <!-- Custom CSS-->
    <link href="{% static 'custom_css/custom_style.css' %}" rel="stylesheet" type="text/css"/>

</head>
<body class="container-fluid">
{% block content %}

{% endblock %}


<!-- Bootstrap5 js starts here-->
<script src="{% static 'bootstrap5/js/bootstrap.bundle.min.js' %}" type="javascript"></script>
<!-- Bootstrap5 js ends here-->
<script src="{% static 'assets/vendor/js/helpers.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/js/config.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/libs/jquery/jquery.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/libs/popper/popper.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/js/bootstrap.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js' %}" type="text/javascript"></script>

<script src="{% static 'assets/vendor/js/menu.js' %}" type="text/javascript"></script>
<!-- endbuild -->

<!-- Vendors JS -->
<script src="{% static 'assets/vendor/libs/apex-charts/apexcharts.js' %}" type="text/javascript"></script>
<!-- Main JS -->
<script src="{% static 'assets/js/main.js' %}" type="text/javascript"></script>

<script async defer src="https://buttons.github.io/buttons.js" type="text/javascript"></script>
<!--JQuery JS-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- Custom JS-->
<script type="text/javascript" src="{% static 'js/script.js' %}"></script>

<!-- Google Map API Add this script tag in the head section -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB_QSTUlqPA9Gr3XH6AQKRfbouVqM97KTc&libraries=places"></script>
<!--Javascript code to refresh data block for every 5 seconds -->
<!--<script>-->
<!--    // Function to refresh the dashboard content-->
<!--    function refreshDashboard() {-->
<!--      // Use jQuery to load the updated content via AJAX-->
<!--      $('#dashboard-content').load('/dashboard/');-->
<!--    }-->

<!--    // Set an interval to refresh the dashboard every 5 seconds (5000 milliseconds)-->
<!--    setInterval(refreshDashboard, 5000);-->
<!--  </script>-->

<!--JavaScripts confirmation script to handle the delete confirmation-->
<!-- Add this script at the end of your template -->
<!--<script>-->
<!--    document.addEventListener('DOMContentLoaded', function () {-->
<!--        var deleteLinks = document.querySelectorAll('.delete-link');-->

<!--        deleteLinks.forEach(function (link) {-->
<!--            link.addEventListener('click', function (event) {-->
<!--                event.preventDefault();-->

<!--                var driverId = link.getAttribute('data-driver-id');-->
<!--                var confirmation = confirm('Are you sure you want to delete this driver?');-->

<!--                if (confirmation) {-->
<!--                    window.location.href = '{% url "delete_driver" 0 %}'.replace('0', driverId);-->
<!--                }-->
<!--            });-->
<!--        });-->
<!--    });-->
<!--</script>-->

<!-- Update the existing script at the end of your template -->
<!--<script>-->
<!--    function locateOnMap(latitude, longitude) {-->
<!--        var defaultCarImage = document.querySelector('[data-default-car-image]').getAttribute('data-default-car-image');-->

<!--        var mapOptions = {-->
<!--            center: new google.maps.LatLng(parseFloat(latitude), parseFloat(longitude)),-->
<!--            zoom: 15,-->

<!--        };-->

<!--        var map = new google.maps.Map(document.getElementById('map'), mapOptions);-->

<!--        var marker = new google.maps.Marker({-->
<!--            position: new google.maps.LatLng(parseFloat(latitude), parseFloat(longitude)),-->
<!--            map: map,-->
<!--            title: 'Tracker Location',-->

<!--        });-->

<!--        var infowindowContent = '<div>' +-->
<!--            '<p>Tracker Location: Latitude ' + latitude + ', Longitude ' + longitude + '</p>' +-->
<!--            '<img src="' + defaultCarImage + '" alt="Car Image">' +-->
<!--            '</div>';-->

<!--        var infowindow = new google.maps.InfoWindow({-->
<!--            content: infowindowContent,-->
<!--        });-->

<!--        marker.addListener('click', function () {-->
<!--            infowindow.open(map, marker);-->
<!--        });-->
<!--    }-->
<!--</script>-->

<script>
    function locateOnMap(latitude, longitude) {
        var defaultCarImage = document.querySelector('[data-default-car-image]').getAttribute('data-default-car-image');

        var mapOptions = {
            center: new google.maps.LatLng(parseFloat(latitude), parseFloat(longitude)),
            zoom: 15,
        };

        var map = new google.maps.Map(document.getElementById('map'), mapOptions);


        // Create a custom overlay for the car image
        var carImage = new google.maps.OverlayView();
        carImage.onAdd = function () {
            var div = document.createElement('div');
            div.style.position = 'absolute';
            div.innerHTML = '<img src="' + defaultCarImage + '" alt="Car Image" style="width: 10px; height: 10px;">';
            this.getPanes().overlayLayer.appendChild(div);
            this.div = div;
        };

        carImage.draw = function () {
            var overlayProjection = this.getProjection();
            var position = overlayProjection.fromLatLngToDivPixel(new google.maps.LatLng(parseFloat(latitude), parseFloat(longitude)));

            this.div.style.left = position.x - 30 + 'px'; // Adjust the positioning based on the image size
            this.div.style.top = position.y - 20 + 'px';
        };

        carImage.setMap(map);

        var infowindowContent = '<div>' +
            '<p>Tracker Location: Latitude ' + latitude + ', Longitude ' + longitude + '</p>' +
            '<img src="' + defaultCarImage + '" alt="Car Image">' +
            '</div>';

        var infowindow = new google.maps.InfoWindow({
            content: infowindowContent,
        });

        // Open infowindow when car image is clicked
        google.maps.event.addDomListener(carImage.div, 'click', function () {
            infowindow.open(map);
        });
    }
</script>
<!-- Script for show and hide password in login page-->
<!--<script>-->
<!--    const togglePassword = document.querySelector('#togglePassword');-->
<!--    const password = document.querySelector('#id_password');-->

<!--    togglePassword.addEventListener('click', function (e) {-->
<!--        // Toggle the password visibility-->
<!--        const type = password.getAttribute('type') === 'password' ? 'text' : 'password';-->
<!--        password.setAttribute('type', type);-->

<!--        // Toggle the button text between 'Show' and 'Hide'-->
<!--        this.textContent = type === 'password' ? 'Show' : 'Hide';-->
<!--    });-->
<!--</script>-->

<script>
    $(document).ready(function () {
        $('#vehicleTable').DataTable();
        $('#driverTable').DataTable();

    });

</script>

<script>
    // JavaScript to populate the update form when "Edit" is clicked
    document.querySelectorAll('[data-bs-target="#carUpdate"]').forEach(button => {
        button.addEventListener('click', function () {
            const car = JSON.parse(this.getAttribute('data-car'));
            document.getElementById('registration_number').value = car.registration_number;
            document.getElementById('registration_date').value = car.registration_date;
            document.getElementById('vehicle_name').value = car.vehicle_name;
            document.getElementById('colour').value = car.colour;
            document.getElementById('model').value = car.model;
            document.getElementById('chassis_number').value = car.chassis_number;
            document.getElementById('tracker').value = car.tracker; // Update tracker dropdown
            document.getElementById('car_id').value = car.id; // Set hidden car_id field
        });
    });
</script>

<script>
    document.querySelectorAll('.modal').forEach(function(modal) {
        modal.addEventListener('hidden.bs.modal', function() {
            modal.querySelector('form').reset();
        });
    });
</script>
</body>
</html>